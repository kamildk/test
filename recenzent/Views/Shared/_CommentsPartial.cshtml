@model recenzent.Models.PublicationCommentViewModel
@using recenzent.Controllers


<script>
    function AddReply(id) {
        var divId = '#CommentReply' + id;
        var cButtonCode = '<button type="button" class = "btn btn-default" id ="cButton" onclick="CancelReply()">Anuluj</button>';
        var aButtonCode = '<button type="submit" class="btn btn-default" id="aButton" >Akceptuj</button>';
        $(divId).append('<textarea class = "form-control", rows = "5", required = "true" id = reply ></textarea>' + cButtonCode + aButtonCode);
    }

    function CancelReply() {
        $('#reply').remove();
        $('#cButton').remove();
        $('#aButton').remove();

        SetSources();
    }

    function SetSources() {
        var length = $("#SourcesList input").length;
        var text = ""
        for (var i = 0; i < length; i++) {
            id = $("#SourcesList input").get(i).id
            text += $('#' + id).val() + "\n";
        }
        $("#testBox").val(text);

        //alert($("#testBox").val());
    }

    function Test() {
        alert($("#testBox").val());
    }
</script>





<div class="container">
    @using (Html.BeginForm("AddComment", "PublicationPanel", FormMethod.Post, new { enctype = "multipart/form-data", Model.PublicationId })) {
        <div class="form-group col-md-10">
            <label class="control-label" for="comment">Skomentuj publikację:</label>
            <div>
                @*<textarea class="form-control" rows="5" id="Description"></textarea>*@
                @Html.TextAreaFor(m => m.newCommentText, new { @class = "form-control", rows = "5", required = "true" })
                @Html.HiddenFor(m => m.PublicationId)
            </div>
        </div>

        <div class="form-group col-md-10">
            <button type="submit" class="btn btn-default">Akceptuj</button>
        </div>
    }
</div>

@foreach (var item in Model.Comments) {

    <div class="well-sm">
        <br />
        <h2>
            <button type="button" class="btn" id="btn1" onclick="AddReply(@item.CommentId)">Dodaj Odpowiedź</button>
        </h2>
        <p>@Html.DisplayFor(modelItem => item.Text)</p>

        @*No nie ogarniam tego szajsu, dziś to już w ogóle nic nowego mi nie wpadło do głowy, tylko nabrudziłem w kodzie. :C *@
        @{string test = "CommentReply" + item.CommentId.ToString();
        }
        <div class="list-group" id=@test>
        </div>


    </div>
    <div>
        @{

            PublicationPanelController ppC = new PublicationPanelController() { };
            var replies = ppC.GetCommentReplies(item);
            foreach (var i in replies) {
                <div class="well-sm" style="margin-left: 20px;">
                    <h2>Tu będzie autor odpowiedzi</h2>
                    <p>@i.Text</p>
                </div>
            }

        }
    </div>
            }
